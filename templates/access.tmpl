<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Authorize App — Example</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg: #f6f7f9;
        --card: #ffffff;
        --muted: #6b7280;
        --accent: #1a73e8;
        --danger: #d93025;
        --radius: 14px;
        --shadow: 0 6px 24px rgba(15, 23, 42, 0.08);
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto;
        background: linear-gradient(180deg, var(--bg), #eef2ff 70%);
        padding: 40px 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        color: #0f172a;
      }

      ul {
        list-style: none;
        padding-left: 0;
      }

      ul li::before {
        content: "✅️ ";
      }

      .container {
        width: 100%;
        max-width: 540px;
      }

      .brand {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 18px;
      }

      .title {
        font-size: 20px;
        font-weight: 600;
        margin: 0;
      }
      .subtitle {
        font-size: 14px;
        color: var(--muted);
      }

      .card {
        background: var(--card);
        padding: 28px;
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        border: 1px solid rgba(15, 23, 42, 0.05);
      }

      .app-info {
        display: flex;
        align-items: center;
        gap: 14px;
        margin-bottom: 18px;
      }
      .app-icon {
        width: 52px;
        height: 52px;
        border-radius: 12px;
        background: #e5edff;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        font-size: 20px;
        color: #1a73e8;
      }

      .scope-list {
        margin: 12px 0;
        padding-left: 20px;
      }
      .scope-list li {
        margin-bottom: 8px;
        font-size: 14px;
      }

      .divider {
        height: 1px;
        background: rgba(15, 23, 42, 0.06);
        margin: 18px 0;
      }

      .actions {
        display: flex;
        gap: 12px;
        margin-top: 10px;
      }
      .btn {
        padding: 12px 16px;
        font-size: 15px;
        font-weight: 600;
        border: none;
        border-radius: 10px;
        cursor: pointer;
      }
      .btn-allow {
        background: var(--accent);
        color: white;
        box-shadow: 0 6px 18px rgba(26, 115, 232, 0.12);
        flex: 1;
      }
      .btn-deny {
        background: #e5e7eb;
        flex: 1;
      }

      .small {
        text-align: center;
        font-size: 12px;
        color: var(--muted);
        margin-top: 12px;
      }
    </style>
  </head>
  <body>
    <main class="container">
      <div class="brand">
        <img src="images/oauth20.png" height="40" />
        <div>
          <h1 class="title">Authorize Application</h1>
          <div class="subtitle">
            An external app is requesting access to your account
          </div>
        </div>
      </div>

      <section class="card">
        <div class="app-info">
          <div class="app-icon">{{ .AppIcon }}</div>
          <div>
            <div style="font-size: 17px; font-weight: 600">{{ .ClientName }}</div>
            <div style="font-size: 13px; color: var(--muted)">
              {{ .ClientURL }}
            </div>
          </div>
        </div>

        <p style="font-size: 14px">
          This app wants to access the following information from your account:
        </p>

        <ul class="scope-list">
        {{ range $scope := .Scopes }}
          <li>{{ $scope }}</li>
        {{ end }}
        </ul>

        <p style="font-size: 14px">
          You can choose what to share. The app will only be able to perform
          actions allowed in the listed scopes.
        </p>

        <div class="divider"></div>

        <div style="font-size: 14px; margin-bottom: 10px">
          Do you trust <strong>{{ .ClientName }}</strong> with your data?
        </div>

        <div class="actions">
          <button class="btn btn-deny" id="denyBtn">Deny</button>
          <button class="btn btn-allow" id="allowBtn">Allow</button>
        </div>

        <div class="small">
          You can revoke access anytime from your account settings.
        </div>
      </section>
    </main>

    <script>
      const allowBtn = document.getElementById("allowBtn");
      const denyBtn = document.getElementById("denyBtn");
      allowBtn.addEventListener("click", () => {
        this.disabled = true;
        this.textContent = "Allowing...";
        denyBtn.disabled = true;
        fetch("/auth" + window.location.search, {
          method: "POST",
          body: JSON.stringify({
            grant: true,
          }),
        })
          .then((response) => {
            // HTTP 302 Redirect
            if (response.redirected) {
              window.location.href = response.url;
            }
          })
          .catch((err) => {
            console.log(err);
          })
          .finally(() => {
            this.disabled = false;
            this.textContent = "Allow";
            denyBtn.disabled = false;
          });
      });

      denyBtn.addEventListener("click", () => {
        this.disabled = true;
        this.textContent = "Denying...";
        allowBtn.disabled = true;
        fetch("/auth" + window.location.search, {
          method: "POST",
          body: JSON.stringify({
            grant: false,
          }),
        })
          .then((response) => {
            // HTTP 302 Redirect
            if (response.redirected) {
              window.location.href = response.url;
            }
          })
          .catch((err) => {
            console.log(err);
          })
          .finally(() => {
            this.disabled = false;
            this.textContent = "Deny";
            allowBtn.disabled = false;
          });
      });
    </script>
  </body>
</html>